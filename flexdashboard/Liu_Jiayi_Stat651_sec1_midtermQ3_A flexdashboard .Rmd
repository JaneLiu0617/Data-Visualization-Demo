---
title: "Liu_Jiayi_Stat651_sec1_midtermQ3_A flexdashboard for fordgobike"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
```

```{r}
library(plotly)
library(tidyverse)
fordgobike <- read.csv("fordgobike_select.csv", stringsAsFactors=FALSE)
```

geom_point
=======================================================================

Row
-----------------------------------------------------------------------

### Scatter Chart with geom_point

```{r}

m <- fordgobike %>% 
  group_by(year, month)%>%
  count()
mp <- m %>%
ggplot(aes(month, n))+geom_point()+facet_wrap(~year)
ggplotly(mp)

```


### geom_smooth with Loess Smoothed Fit

```{r}
m <- fordgobike %>% 
  group_by(year, month)%>%
  count()
mp <- m %>%
ggplot(aes(month, n))+geom_point()+geom_smooth()+facet_wrap(~year)
ggplotly(mp)
```



Row
-----------------------------------------------------------------------
### geom_smooth Linear Regression

```{r}
m <- fordgobike %>% 
  group_by(year, month)%>%
  count()
mp <- m %>%
ggplot(aes(month, n))+geom_point()+geom_smooth(method= lm)+facet_wrap(~year)
ggplotly(mp)
```


### Add Explain 

From month plot, we can find that the numbers of users of 2017 is smaller than those of 2018. 

In 2017,  the number startes from June, increased by month and began to decrease from October. In my opinion, the reason is seasonal aspect that people who ride bycle is less in winter.

In 2018, the number increased from Janurary to July and decreased from Augest, and the reason is still the season. Because Spring and Summer are suitble to ride a bycle, but increase again in October. I think maybe the quickly increase meet a peak of the two year and begin to fluctuate.

Compare the two type smooth lines, we can easily find that Loess Smoothed Fit is better than linear regression.


geom_bar
=======================================================================

Row
-----------------------------------------------------------------------

### year's bar 

```{r}
bp <-fordgobike %>%
  group_by(year)%>%
 ggplot(aes(year))+geom_bar()
ggplotly(bp)
```



Column {.tabset}
-----------------------------------------------------------------------
### month's bar 

```{r}
cp <-fordgobike %>% ggplot(aes(x=month), color= pink) + geom_bar()+ facet_grid(year ~ .)
ggplotly(cp)
```



### Add Explain 

From the year plot, we can easily find that the number of users of 2017 is smaller that those of 2018. There are two reasons: 

(1) The company started from 2017 and the users would increase with the development; 

(2) There are more people would like to have a ride in spring and summer than in fall and winter.

Compare year's bar graph and month bar graph, we can find that each month of 2018 is bigger than corresponding month of 2017.


